jQuery(window).on("load", function() {
    $('#preloader').fadeOut(500);
    $('#main-wrapper').addClass('show');
});

$(document).ready(function () {
    "use strict";



    /*
    -------------------
    List item active
    -------------------*/
    $('.icons')
        .on('click', function() {
            $(".icons.active")
                .removeClass("active");
            $(this)
                .addClass('active');
        });

    $(".icons")
        .on("click", function(event) {
            event.stopPropagation();
        });

    $(document)
        .on("click", function() {
            $(".icons")
                .removeClass("active");

        });


    $("#menu").metisMenu();

    $('.nk-nav-scroll').slimscroll({
        position: "left",
        size: "5px",
        height: "100%",
        color: "transparent"
    });


    $(".nav-control").on('click', function() {
        $("body").toggleClass("mini-nav");
        $(".hamburger").toggleClass("is-active");
    });


    $(function() {
        for (var nk = window.location, o = $("ul#menu a").filter(function() {
                    return this.href == nk;
                })
                .addClass("active")
                .parent()
                .addClass("active");;) {
            if (!o.is("li")) break;
            o = o.parent()
                .addClass("in")
                .parent()
                .addClass("active");
        }
    });

    $(function() {
        var win_w = window.innerWidth;
        var win_h = window.innerHeight;
        if (win_w <= 1170) {
            $("body").addClass("mini-nav");

        } else {
            $("body").removeClass("mini-nav");
        };
        var win_h = window.innerHeight;
        if (win_h > 0 ? win_h : screen.height) {
            $(".content-body").css("min-height", (win_h + 60) + "px");
        };
    });




    /*==============================================
		Custom Dropdown
		 ===============================================*/


    $('.drop-menu').on('click', function() {
        $(this).attr('tabindex', 1).focus();
        $(this).toggleClass('active');
        $(this).find('.dropeddown').slideToggle(300);
    });
    $('.drop-menu').focusout(function() {
        $(this).removeClass('active');
        $(this).find('.dropeddown').slideUp(300);
    });
    $('.drop-menu .dropeddown li').on('click', function() {
        $(this).parents('.drop-menu').find('span').text($(this).text());
        $(this).parents('.drop-menu').find('input').attr('value', $(this).attr('id'));
    });




    $('[data-toggle="popover"]').popover();
    $('[data-toggle="tooltip"]').tooltip();





$('body').attr('class', 'v-light fix-nav fix-header');




//-------------------------------------------
//-----Breadcrumbs based on URL location
//-------------------------------------------
// if ($('ol.breadcrumb')) {
//   var here = location.href.replace(/(\?.*)$/, '').split('/').slice(3);
//   var parts = [{
//     "text": 'Home',
//     "link": '/'
//   }];

//   for (var j = 0; j < here.length; j++) {
//     var part = here[j];
//     var pageName = part.toLowerCase();

//     pageName = part.charAt(0).toUpperCase() + part.slice(1);
//     var link = '/' + here.slice(0, j + 1).join('/');
//     $('ol.breadcrumb').append('<li class="breadcrumb-item"><a href="' + link + '">' + pageName.replace(/\.(htm[l]?|html#[l]?|asp[x]?|asp#[x]?|php|php#|jsp)$/, '') + '</a></li>');
//     parts.push({
//       "text": pageName,
//       "link": link
//     });
//   }
// }


        //---------------------------------
        // read more & read less
        //---------------------------------


        // Configure/customize these variables.
          var showChar = 180;  // How many characters are shown by default
          var ellipsestext = "...";
          var moretext = "Read more >";
          var lesstext = "Read less";
          

          $('.more').each(function() {
              var content = $(this).html();
       
              if(content.length > showChar) {
       
                  var c = content.substr(0, showChar);
                  var h = content.substr(showChar, content.length - showChar);
       
                  var html = c + '<span class="moreellipses">' + ellipsestext+ '&nbsp;</span><span class="morecontent"><span>' + h + '</span>&nbsp;&nbsp;<a href="" class="morelink">' + moretext + '</a></span>';
       
                  $(this).html(html);
              }
       
          });
       
          $(".morelink").click(function(){
              if($(this).hasClass("less")) {
                  $(this).removeClass("less");
                  $(this).html(moretext);
              } else {
                  $(this).addClass("less");
                  $(this).html(lesstext);
              }
              $(this).parent().prev().toggle();
              $(this).prev().toggle();
              return false;
          });






  $('.add-contact').click(function (e) {
    e.preventDefault();
    var id = $(".nav-tabs").children().length; //think about it ;)
    var tabId = 'contact_' + id;
    $(this).closest('li').before('<li><a href="#contact_' + id + '">Loan ' + id + '</a></li>');


    var cloneLoan = $('#anaBody').clone();

    $('.tab-content').append('<div class="tab-pane" id="' + tabId + '"></div>').show('slow');

    $('#' + tabId).append(cloneLoan);

    $('.nav-tabs li:nth-child(' + id + ') a').click();


  });

  $('.delete_row').click(function (e) {
    e.preventDefault();
    $(this).closest('tr').remove()
  })




//---------------------------
//---refer friend
//---------------------------
var max_fields      = 5; //maximum input boxes allowed
  var wrapper       = $(".input_fields_wrap"); //Fields wrapper
  var add_button      = $(".add_field_button"); //Add button ID

  var x = 1; //initlal text box count
  $(add_button).click(function(e){ //on add input button click
    e.preventDefault();
      if(x < max_fields){ //max input box allowed
        x++; //text box increment
        $(wrapper).append('<div class="form-group"><input class="form-control" type="email" name="friend_email[]" placeholder="Email Address"/><a href="#" class="btn btn-link text-danger remove_field">Remove</a></div>'); //add input box
      }
    });

  $(wrapper).on("click",".remove_field", function(e){ //user click on remove text
    e.preventDefault(); $(this).parent('div').remove(); x--;
});









//------------------------------------------
// iCheck Jquery
//------------------------------------------

  $('.check').iCheck({
      checkboxClass: 'icheckbox_square-blue',
      radioClass: 'iradio_square-blue',
      increaseArea: '20%'
  });



//------------------------------
// Add New Profile 
//------------------------------
//-----------Add new profile to entity form
    $('#newProfile').hide();

    $('#addNewProfile').click(function(){
      $('#newProfile').fadeIn();
    });

    $('#removeNewProfile').click(function(){
      $('#newProfile').fadeOut();
    });



//collapse accordion
// Add minus icon for collapse element which is open by default
    $(".collapse.show").each(function(){
      $(this).prev(".card-header").find(".fa").addClass("fa-minus").removeClass("fa-plus");
    });
    
    // Toggle plus minus icon on show hide of collapse element
    $(".collapse").on('show.bs.collapse', function(){
      $(this).prev(".card-header").find(".fa").removeClass("fa-plus").addClass("fa-minus");
    }).on('hide.bs.collapse', function(){
      $(this).prev(".card-header").find(".fa").removeClass("fa-minus").addClass("fa-plus");
    });     


});